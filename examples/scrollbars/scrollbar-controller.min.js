function debounce(t,a){if(!(this instanceof debounce)){var e=new debounce(t,a);return function(){e._()}}var i;this._=function(){i||(i=setTimeout(function(){i=null,t()},a))}}function activate(){return this.data.active||(this.data.active=!0,this.data.bar.get("dp-main").setState("active","fade","",300,"fade","",300)),this}function deactivate(t){return(this.data.active||t)&&(this.data.active=!1,this.data.bar.get("dp-main").setState("idle","fade","",300,"fade","",300)),this}function delayedDeactivation(){this.cancelDelayedDeactivation(),this.deactivate()}function cancelDelayedDeactivation(){this.data.ddId&&(clearTimeout(this.data.ddId),this.data.ddId=null)}function onHandleHover(){return this.data.handleDrag?this.data.shouldDeactivateOnDrop=!1:this.cancelDelayedDeactivation(),this}function onHandleOut(){return this.data.handleDrag?this.data.shouldDeactivateOnDrop=!0:(this.cancelDelayedDeactivation(),this.data.ddId=setTimeout(delayedDeactivation.bind(this),deactivationDelay)),this}function onHandleDragStart(){this.data.handleDrag=!0}function onHandleDrag(){var t=_dimmensions[this.data.barType+2],a=this.data.bar.get("dp-main/handle-active").getRect()[t];a=Math.min(this.data.barMaxScroll,Math.max(0,a));var e=Math.round(a/this.data.barMaxScroll*this.data.maxScroll);if(e!==this.data.scroll){if(this.data.scroll=e,this.data.content){var i=[0,0];i[this.data.barType]=e-this.data.content.getRect()[t],this.data.content.moveBy.apply(this.data.content,i)}this.data.bar.fireEvent("OnChange",e)}}function onHandleDragDrop(){this.data.handleDrag=!1;var t=this.data.bar.get("dp-main/handle-active"),a=t.getRect()[_dimmensions[this.data.barType+2]],e=0>a?-a:a>this.data.barMaxScroll?this.data.barMaxScroll-a:0;if(0!==e){var i=[0,0];i[this.data.barType]=e,t.moveBy.apply(t,i),t.moveBy.apply(this.data.bar.get("dp-main/handle-idle"),i)}return this.data.shouldDeactivateOnDrop&&this.deactivate(!0),this}function attachContent(t){if("dynamicPanel"===t.type){this.data.content=t;var a=_dimmensions[this.data.barType];this.data.maxScroll=t.getParent().getRect()[a]-t.getRect()[a]}}function getScroll(){return this.data.scroll||0}function init(){var t=this.data.bar=this.getOwner(),a=t.get("dp-main").getRect(),e=t.get("dp-main/handle-active").getRect();a.width>a.height?(this.data.barType=0,this.data.barMaxScroll=a.width-e.width):(this.data.barType=1,this.data.barMaxScroll=a.height-e.height),this.data.maxScroll=100,this.onHandleDrag=debounce(onHandleDrag.bind(this),100),_ownerApi.forEach(function(a){t[a]=this[a].bind(this)},this),t.get("dp-main/bs-activator").enable()}var _ownerApi=["attachContent","getScroll","onHandleHover","onHandleOut","onHandleDragStart","onHandleDragDrop"],_dimmensions=["width","height","x","y"],deactivationDelay=500;$.extend(masterContext,{autostart:!0,activate:activate,deactivate:deactivate,delayedDeactivation:delayedDeactivation,cancelDelayedDeactivation:cancelDelayedDeactivation,onHandleHover:onHandleHover,onHandleOut:onHandleOut,onHandleDragStart:onHandleDragStart,onHandleDragDrop:onHandleDragDrop,attachContent:attachContent,getScroll:getScroll,init:init});